##索引的作用是什么

* 加速查询

##Mysql索引实现

* MyISAM索引实现 
    *  MyISAM引擎使用B+Tree作为索引结构，如果指定的Key存在，则取出其data域的值，然后以data域的值为地址，读取相应数据记录。MyISAM的索引方式也叫做“非聚集”的，之所以这么称呼是为了与InnoDB的聚集索引区分。
* InnoDB索引实现
    * InnoDB也使用B+Tree作为索引结构，但具体实现方式却与MyISAM截然不同。第一个重大区别是InnoDB的数据文件本身就是索引文件。从上文知道，MyISAM索引文件和数据文件是分离的，索引文件仅保存数据记录的地址。而在InnoDB中，表数据文件本身就是按B+Tree组织的一个索引结构，这棵树的叶节点data域保存了完整的数据记录。这个索引的key是数据表的主键，因此InnoDB表数据文件本身就是主索引。
第二个与MyISAM索引的不同是InnoDB的辅助索引data域存储相应记录主键的值而不是地址。换句话说，InnoDB的所有辅助索引都引用主键作为data域。
知道了InnoDB的索引实现后，就很容易明白为什么不建议使用过长的字段作为主键，因为所有辅助索引都引用主索引，过长的主索引会令辅助索引变得过大 

##索引类型

* 普通索引
    * 是最基本的索引，它没有任何限制。   
* 唯一索引
    * 与前面的普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。     
* 主键索引
    * 是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。一般是在建表的时候同时创建主键索引
* 组合索引
    *  指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用组合索引时遵循最左前缀集合

##最左前缀原理
* 查询的时候如果where条件里面最左边的一到多列，索引就不会起作用。

```
例如： index（a,b,c）
select a, b, c from t where b=0 and c=1  //不会使用索引
select a, b, c from t where a=0 and c=1  //会使用索引
```
##聚合索引和非聚合索引的区别
* 两者的根本区别是表记录的排列顺序和与索引的排列顺序是否一致。
    * 聚集索引一个表只能有一个，而非聚集索引一个表可以存在多个。
    * 聚集索引存储记录是物理上连续存在，而非聚集索引是逻辑上的连续，物理存储并不连续。
    * 聚集索引查询数据速度快，插入数据速度慢；非聚集索引反之
    
##聚集索引的优点有：
* 可以把相关数据存储在一起，减少数据查询时的磁盘I/O
* 数据访问更快，因为聚簇索引就是表，索引和数据保存在一个B+Tree中
* 使用索引覆盖的查询时可以直接使用页节点中的主键值
##聚簇索引的缺点有：
* 插入速度严重依赖插入顺序
* 更新聚簇索引列的代价很高，因为会强制InnoDB把更新的列移动到新的位置
* 基于聚簇索引的表在插入新行，或者主键被更新导致需要移动行的时候，可能会导致“页分裂”。当行的主键值要求必须将这一行插入到已满的页中时，存储引擎会将该页分裂为两个页面来容纳该行，这就是一次页分裂操作，页分裂会导致表占用更多的存储空间。

##B+Tree
* B+Tree是在B-Tree基础上的一种优化，使其更适合实现外存储索引结构，InnoDB存储引擎就是用B+Tree实现其索引结构。
在B+Tree中，所有数据记录节点都是按照键值大小顺序存放在同一层的叶子节点上，而非叶子节点上只存储key值信息，这样可以大大加大每个节点存储的key值数量，降低B+Tree的高度。
##### B+Tree相对于B-Tree有几点不同：
* 非叶子节点只存储键值信息。
* 所有叶子节点之间都有一个链指针。
* 数据记录都存放在叶子节点中。

    ![image](http://images2015.cnblogs.com/blog/249993/201705/249993-20170531161139243-491884410.png)
    
* 通常在B+Tree上有两个头指针，一个指向根节点，另一个指向关键字最小的叶子节点，而且所有叶子节点（即数据节点）之间是一种链式环结构。因此可以对B+Tree进行两种查找运算：一种是对于主键的范围查找和分页查找，另一种是从根节点开始，进行随机查找。
数据库中的B+Tree索引可以分为聚集索引（clustered index）和辅助索引（secondary index）。
上面的B+Tree示例图在数据库中的实现即为聚集索引，聚集索引的B+Tree中的叶子节点存放的是整张表的行记录数据。
辅助索引与聚集索引的区别在于辅助索引的叶子节点并不包含行记录的全部数据，而是存储相应行数据的聚集索引键，即主键。当通过辅助索引来查询数据时，InnoDB存储引擎会遍历辅助索引找到主键，然后再通过主键在聚集索引中找到完整的行记录数据。
